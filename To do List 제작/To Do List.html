<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To Do List</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #f9f9f9; }
        h2 { color: #333; }
        textarea { width: 100%; padding: 10px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc; resize: none; }
        #add-btn { margin-top: 10px; padding: 10px 20px; border: none; border-radius: 5px; background-color: #4CAF50; color: white; cursor: pointer; font-size: 16px; }
        #add-btn:hover { background-color: #45a049; }
        ul { list-style: none; padding: 0; margin-top: 20px; }
        li { padding: 10px; margin-bottom: 10px; border-radius: 5px; background: #fff; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .todo-text { white-space: pre-wrap; word-break: break-word; flex: 1; }
        .actions button { margin-left: 5px; padding: 5px 10px; border: none; border-radius: 4px; cursor: pointer; color: white; }
        .edit-btn { background-color: #FF9800; }
        .edit-btn:hover { opacity: 0.8; }
        .delete-btn { background-color: #f44336; }
        .delete-btn:hover { opacity: 0.8; }
        .edit-textarea { width: 100%; border: 1px solid #ccc; border-radius: 5px; padding: 5px; font-size: 16px; resize: none; }
    </style>
</head>
<body>

<h2>To Do List</h2>
<textarea id="todo-input" placeholder="할 일을 입력하세요" rows="2"></textarea>
<button id="add-btn">추가</button>
<ul id="todo-list"></ul>

<script>
    const todoInput = document.getElementById('todo-input');
    const addBtn = document.getElementById('add-btn');
    const todoList = document.getElementById('todo-list');

    function createTodoItem(text) {
      const li = document.createElement('li');

      const div = document.createElement('div');
      div.className = 'todo-text';
      div.textContent = text;
      li.appendChild(div);

      const actions = document.createElement('div');
      actions.className = 'actions';

      const editBtn = document.createElement('button');
      editBtn.className = 'edit-btn';
      editBtn.textContent = '수정';

      const deleteBtn = document.createElement('button');
      deleteBtn.className = 'delete-btn';
      deleteBtn.textContent = '삭제';

      actions.appendChild(editBtn);
      actions.appendChild(deleteBtn);
      li.appendChild(actions);

      todoList.appendChild(li);
    }

    function addTodo() {
      const text = todoInput.value.trim();
      if (!text) return;
      createTodoItem(text);
      todoInput.value = '';
    }

    // 버튼 클릭 시 추가
    addBtn.addEventListener('click', addTodo);

    // Enter 키 처리: keyup에서 처리 → 마지막 글자 중복 문제 해결
    todoInput.addEventListener('keyup', e => {
      if (e.key === 'Enter' && !e.shiftKey) {
        addTodo();
      }
    });

    // 수정, 삭제 기능
    todoList.addEventListener('click', e => {
      const li = e.target.closest('li');
      if (!li) return;

      if (e.target.classList.contains('delete-btn')) {
        li.remove();
      }

      if (e.target.classList.contains('edit-btn')) {
        const div = li.querySelector('.todo-text');
        const textarea = document.createElement('textarea');
        textarea.className = 'edit-textarea';
        textarea.value = div.textContent;
        li.replaceChild(textarea, div);
        textarea.focus();

        function finishEdit() {
          const newText = textarea.value.trim();
          if (newText) {
            div.textContent = newText;
            li.replaceChild(div, textarea);
          } else {
            li.remove();
          }
        }

        textarea.addEventListener('keydown', ev => {
          if (ev.key === 'Enter' && !ev.shiftKey) {
            ev.preventDefault();
            finishEdit();
          }
        });

        textarea.addEventListener('blur', finishEdit);
      }
    });
</script>

</body>
</html>
